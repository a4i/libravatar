{% extends 'base.html' %}
{% load i18n %}

{% block title %}{% trans 'Add a new email address' %} - Libravatar{% endblock title %}

{% block body-onload %}document.forms.addemail.email.focus(){% endblock body-onload %}
{% block content %}

<h1>{% trans 'Add a new email address' %}</h1>

<p>{% blocktrans with 'javascript:try_browserid()' as browserid_target %}If you have a <a href="https://browserid.org">BrowserID</a> account, you can <a href="{{browserid_target}}">use it to add a new email address</a> to your profile.{% endblocktrans %}</p>

{# Invisible form to process BrowserID assertions #}
<form id="browserid-form" action="{% url libravatar.account.views.add_browserid %}" name="addbrowserid" method="post">{% csrf_token %}
<input id="browserid-assertion" type="hidden" name="assertion" value="">
<input style="display: none" type="submit">
</form>

<p>{% blocktrans %}Otherwise, type your email address in the box below and we will send you an email with a link to click on in order to verify that you own that email address.{% endblocktrans %}</p>

<form action="{% url libravatar.account.views.add_email %}" name="addemail" method="post">{% csrf_token %}

{{ form.email.errors }}
<p class="aligned wide">{{ form.email.label_tag }}: {{ form.email }}</p>

<p><input type="submit" value="{% trans 'Add' %}" />
&nbsp;<a href="{% url libravatar.account.views.profile %}">{% trans 'Cancel' %}</a></p>

</form>

<script src="https://browserid.org/include.js" type="text/javascript"></script>
<script type="text/javascript">
function try_browserid() {
    navigator.id.getVerifiedEmail(function(assertion) {
        if (assertion) {
            document.getElementById('browserid-assertion').setAttribute('value', assertion);
            document.getElementById('browserid-form').submit();
        }
    });
}
</script>

{% endblock content %}
